(this["webpackJsonpship-stabi"]=this["webpackJsonpship-stabi"]||[]).push([[15],{195:function(e,a,t){"use strict";t.r(a);var r=t(117),s=t.n(r),n=t(118),l=t(26),o=t(1),c=t(10),m=t(11),i=t(13),d=t(12),u=t(0),p=t.n(u),b=t(24),E=t(140),h=t(185),f=t(122),N=t(213),U=t(23),y=t(131),O=t(80),v=t.n(O),j=t(81),C=t.n(j),w=t(93),S=t.n(w),g=t(59),L=t(73),A=t.n(L),I=t(74),P=t.n(I),F=t(67),R=t(3),x=function(e){return{type:R.r,userList:e}},D=function(e){return{type:R.G,recordUpdateStatus:e}},k=function(e){return{type:R.k,error:e}},G=function(){return{type:R.f}},V={headers:{}},M=function(e){return function(a){A.a.post(F.a+"".concat("Employee","/AddEmployee"),e,V).then((function(e){var t;0===e.data.status?(a((t=e.data.message,{type:R.E,recordSaveStatus:t})),a(G())):(a(k(e.data.message)),a(G()))})).catch((function(e){console.log(e),e.response?(a(k(e.response.data.message||"ERROR")),a(G())):(a(k("API Error. Please contact administrator.")),a(G()))}))}},H=t(82),W=function(e){Object(i.a)(t,e);var a=Object(d.a)(t);function t(){var e;return Object(c.a)(this,t),(e=a.call(this)).sweetAlertHandler=function(e){C()(v.a).fire({title:e.title,text:e.text,type:e.type})},e.handleDelete=function(a){var t=C()(v.a);t.fire({title:"Are you sure?",text:"Once deleted, you will not be able to recover this user!",type:"warning",showCloseButton:!0,showCancelButton:!0}).then((function(r){if(!r.value)return t.fire("","Your user record is safe!","info");var s=e.state.data.find((function(e){return e.ID===a})),n={ID:a};e.props.deletUser(n);var l=e.state.data.indexOf(s);l>-1&&e.state.data.splice(l,1),e.setState({data:e.state.data})})).finally((function(){e.setState({isOpen:!0})}))},e.handleEdit=function(a){var t=e.state.data.find((function(e){return e.ID===a})),r={ID:a,EmployeeNumber:t.EmployeeNumber,FirstName:t.FirstName,MiddleName:t.MiddleName,LastName:t.LastName};t.IsUser&&(e.setState({isSystemUser:!0}),r=Object(o.a)(Object(o.a)({},r),{},{UserName:t.UserName,UserRole:!0===t.IsAdmin?"Admin":"User"})),e.setState({userObj:r,isEditUserCode:!1}),e.setState({isSearch:!1,isAdd:!0}),window.scrollTo({top:0,behavior:"smooth"})},e.handleAddUser=function(a){e.clearValue(a),e.setState({isSearch:!1,isAdd:!0})},e.handleIsSystemUser=function(a){e.setState({isSystemUser:!0})},e.handleIsNormalUser=function(a){e.setState({isSystemUser:!1})},e.handleCloseAddUser=function(a){e.clearValue(a),e.setState({isSearch:!0,isAdd:!1,isSystemUser:!1})},e.handleFormChange=function(a,t,r,s){try{var n=a.target,c=n.name,m=n.value;e.setState(Object(l.a)({},t,Object(o.a)(Object(o.a)({},e.state[t]),{},Object(l.a)({},c,m))))}catch(i){console.log(i)}},e.clearValue=function(a){e.setState({userObj:{ID:"",EmployeeNumber:"",FirstName:"",MiddleName:"",LastName:"",UserName:"",Password:"",ConfPassword:"",UserRole:"",Vessel:""},isEditUserCode:!0,isSystemUser:!1})},e.handleSubmit=Object(n.a)(s.a.mark((function a(){var t,r;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:Object(g.a)(e.state.userObj.ID)?Object(g.a)(e.state.userObj.EmployeeNumber)?e.sweetAlertHandler({title:"Error",text:"Please fill all required fileds",type:"error"}):(v.a.showLoading(),(t=new FormData).append("EmployeeNumber",e.state.userObj.EmployeeNumber),t.append("FirstName",e.state.userObj.FirstName),t.append("MiddleName",e.state.userObj.MiddleName),t.append("LastName",e.state.userObj.LastName),t.append("IsUser",!!e.state.isSystemUser),t.append("IsLocked",!1),t.append("IsActive",!0),t.append("Vessel",e.state.userObj.Vessel),!e.state.isSystemUser||Object(g.a)(e.state.userObj.Password)||Object(g.a)(e.state.userObj.ConfPassword)?e.state.isSystemUser?e.sweetAlertHandler({title:"Error",text:"Please enter password and confirm password",type:"error"}):e.props.saveSingleUser(t):(t.append("UserName",e.state.userObj.UserName),t.append("Password",e.state.userObj.Password),t.append("IsAdmin","Admin"===e.state.userObj.UserRole),e.state.userObj.Password===e.state.userObj.ConfPassword?e.props.saveSingleUser(t):e.sweetAlertHandler({title:"Error",text:"Confirm password not match with password",type:"error"}))):(v.a.showLoading(),(r=new FormData).append("ID",e.state.userObj.ID),r.append("EmployeeNumber",e.state.userObj.EmployeeNumber),r.append("FirstName",e.state.userObj.FirstName),r.append("MiddleName",e.state.userObj.MiddleName),r.append("LastName",e.state.userObj.LastName),r.append("IsUser",!!e.state.isSystemUser),r.append("IsLocked",!1),r.append("IsActive",!0),r.append("Vessel",e.state.userObj.Vessel),e.state.isSystemUser?(r.append("UserName",e.state.userObj.UserName),r.append("IsAdmin","Admin"===e.state.userObj.UserRole),Object(g.a)(e.state.userObj.Password)||Object(g.a)(e.state.userObj.ConfPassword)?e.props.updateSingleUser(r):(r.append("Password",e.state.userObj.Password),e.state.userObj.Password===e.state.userObj.ConfPassword?e.props.updateSingleUser(r):e.sweetAlertHandler({title:"Error",text:"Confirm password not match with password",type:"error"}))):e.props.updateSingleUser(r)),window.location.href("https://shipstab-build.vercel.app/able-pro/react/default/others/user");case 2:case"end":return a.stop()}}),a)}))),e.state={data:[],isSearch:!0,isAdd:!1,userObj:"",isEditUserCode:!0,isSystemUser:!1,vesselList:[]},e.columns=[{name:"ID",selector:"ID",omit:!0},{name:"Actions",cell:function(a){return p.a.createElement(p.a.Fragment,null,p.a.createElement(E.a,{className:"btn btn-sm btn-info mr-1",outline:!0,onClick:function(){return e.handleEdit(a.ID)}},p.a.createElement("i",{className:"fa fa-edit"})),p.a.createElement(E.a,{className:"btn btn-sm btn-dark",outline:!0,onClick:function(){return e.handleDelete(a.ID)}},p.a.createElement("i",{className:"fa fa-trash"})))}},{name:"User Code",selector:"EmployeeNumber"},{name:"Full Name",selector:"FullName"},{name:"Username",selector:"UserName"},{name:"User Role",cell:function(e){return p.a.createElement(p.a.Fragment,null,!0===e.IsAdmin?p.a.createElement("span",{className:"badge badge-info"},"Admin"):p.a.createElement("span",{className:"badge badge-dark"},"User"))}}],e}return Object(m.a)(t,[{key:"componentWillReceiveProps",value:function(e){Object(g.a)(e.userList)||this.setState({data:e.userList}),Object(g.a)(e.recordSaveStatus)||(this.sweetAlertHandler({title:"Success",text:e.recordSaveStatus,type:"success"}),setTimeout((function(){window.location.reload(!1)}),1800)),Object(g.a)(e.vesselList)||this.setState({vesselList:e.vesselList}),Object(g.a)(e.recordUpdateStatus)||(this.sweetAlertHandler({title:"Success",text:e.recordUpdateStatus,type:"success"}),setTimeout((function(){window.location.reload(!1)}),1800)),Object(g.a)(e.error)||this.sweetAlertHandler({title:"Error",text:e.error,type:"error"})}},{key:"componentDidMount",value:function(){this.props.getAllUserList(),this.props.getAllVesselList()}},{key:"render",value:function(){var e=this,a=this.state,t=a.isSearch,r=a.isAdd,s=a.userObj,n=a.isEditUserCode,l=a.isSystemUser,c=a.vesselList,m=(a.Vessel,this.columns.map((function(a){return a.editable?Object(o.a)(Object(o.a)({},a),{},{onCell:function(a){return{record:a,editing:e.isEditing(a)}}}):a})));return p.a.createElement(U.a,null,p.a.createElement(h.a,null,p.a.createElement(f.a,null,t&&p.a.createElement(y.a,{title:"Search User"},p.a.createElement(N.a.Row,null,p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"User Code"),p.a.createElement(N.a.Control,{type:"text",id:"EmployeeNumber",placeholder:"User Code"})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"User Name"),p.a.createElement(N.a.Control,{type:"text",id:"UserName",placeholder:"User Name"})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Full Name"),p.a.createElement(N.a.Control,{type:"text",id:"FullName",placeholder:"Full Name"})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"User Role"),p.a.createElement(N.a.Control,{type:"text",id:"IsAdmin",placeholder:"User Role"}))),p.a.createElement(N.a.Row,null,p.a.createElement(N.a.Group,{as:f.a,md:"12"},p.a.createElement("center",null,p.a.createElement(E.a,{type:"button",style:{minWidth:"200px"},variant:"info",className:"m-3",disabled:!0},"Search"),p.a.createElement(E.a,{style:{minWidth:"200px"},variant:"dark",className:"m-3",disabled:!0},"Clear"))))),r&&p.a.createElement(y.a,{title:"Manage User"},p.a.createElement(N.a.Row,null,p.a.createElement(N.a.Group,{style:{display:"none"}},p.a.createElement(N.a.Label,null,"ID"),p.a.createElement(N.a.Control,{type:"text",id:"ID",name:"ID",onChange:function(a){return e.handleFormChange(a,"userObj")},value:s.ID})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"User Code"),p.a.createElement(N.a.Control,{type:"text",id:"EmployeeNumber",name:"EmployeeNumber",placeholder:"User Code",onChange:function(a){return e.handleFormChange(a,"userObj")},value:s.EmployeeNumber,disabled:!n})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"First Name"),p.a.createElement(N.a.Control,{type:"text",id:"FirstName",name:"FirstName",placeholder:"First Name",onChange:function(a){return e.handleFormChange(a,"userObj")},value:s.FirstName})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Middle Name"),p.a.createElement(N.a.Control,{type:"text",id:"MiddleName",name:"MiddleName",placeholder:"Middle Name",onChange:function(a){return e.handleFormChange(a,"userObj")},value:s.MiddleName})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Last Name"),p.a.createElement(N.a.Control,{type:"text",id:"LastName",name:"LastName",placeholder:"Last Name",onChange:function(a){return e.handleFormChange(a,"userObj")},value:s.LastName})),!l&&p.a.createElement(E.a,{className:"btn btn-sm btn-info",onClick:function(a){return e.handleIsSystemUser(a)}},"Is System User"),l&&p.a.createElement(E.a,{className:"btn btn-sm btn-dark",onClick:function(a){return e.handleIsNormalUser(a)}},"Is Normal User")),l&&p.a.createElement(p.a.Fragment,null,p.a.createElement("hr",null),p.a.createElement(N.a.Row,null,p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Username"),p.a.createElement(N.a.Control,{type:"text",id:"UserName",name:"UserName",placeholder:"Username",onChange:function(a){return e.handleFormChange(a,"userObj")},value:s.UserName})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Password"),p.a.createElement(N.a.Control,{type:"password",id:"Password",name:"Password",placeholder:"Password",onChange:function(a){return e.handleFormChange(a,"userObj")}})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Confirm Password"),p.a.createElement(N.a.Control,{type:"password",id:"ConfPassword",name:"ConfPassword",placeholder:"Confirm Password",onChange:function(a){return e.handleFormChange(a,"userObj")}})),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"User Role"),p.a.createElement("select",{className:"form-control add_task_todo",onChange:function(a){return e.handleFormChange(a,"userObj")},name:"UserRole",id:"UserRole",value:s.UserRole},p.a.createElement("option",{value:""},"Select User Role"),p.a.createElement("option",{value:"Admin"},"Admin"),p.a.createElement("option",{value:"User"},"User"))),p.a.createElement(N.a.Group,{as:f.a,md:"3"},p.a.createElement(N.a.Label,null,"Vessel"),p.a.createElement("select",{className:"form-control add_task_todo",onChange:function(a){return e.handleFormChange(a,"userObj")},name:"Vessel",id:"Vessel",value:s.vesselName},p.a.createElement("option",{value:""},"Select Vessel Name"),!Object(g.a)(c)&&c.map((function(e,a){return p.a.createElement("option",{key:a,value:e.ID},e.VesselName)})))))),p.a.createElement(N.a.Row,null,p.a.createElement(N.a.Group,{as:f.a,md:"12"},p.a.createElement("center",null,p.a.createElement(E.a,{type:"button",style:{minWidth:"200px"},variant:"info",className:"m-3",onClick:this.handleSubmit},"Save"),p.a.createElement(E.a,{style:{minWidth:"200px"},variant:"dark",className:"m-3",onClick:function(a){return e.handleCloseAddUser(a)}},"Cancel"))))))),p.a.createElement(h.a,null,p.a.createElement(f.a,{xl:12},p.a.createElement("nav",{className:"navbar m-b-10 p-10"},p.a.createElement("ul",{className:"nav"},p.a.createElement("li",{className:"nav-item f-text active"}),p.a.createElement("li",{className:"nav-item f-text active"})),p.a.createElement("div",{className:"nav-item nav-grid f-view"},p.a.createElement(E.a,{type:"button",style:{minWidth:"200px"},variant:"info",onClick:function(a){return e.handleAddUser(a)}},"Add User"))))),p.a.createElement(h.a,null,p.a.createElement(f.a,null,p.a.createElement(y.a,{title:"Users List"},p.a.createElement(S.a,Object.assign({noHeader:!0,responsive:!0,theme:"default"},this.state,{columns:m,paginationPerPage:2,className:"react-dataTable",data:this.state.data}))))))}}]),t}(u.Component);a.default=Object(b.b)((function(e){return{userList:e.userList,recordSaveStatus:e.recordSaveStatus,recordUpdateStatus:e.recordUpdateStatus,error:e.error,vesselList:e.vesselList}}),(function(e){return{getAllUserList:function(a){return e((t=a,function(e){e(x([])),A.a.get(F.a+"".concat("Employee","/GetAllEmployees?").concat(P.a.stringify(t)),V).then((function(a){console.log(a.data),Object(g.a)(a.data)?(e(k("Error fetching list of users")),e(G())):(e(x(a.data)),e(G()))})).catch((function(a){a.response?(e(k(a.response.data.message||"ERROR")),e(G())):(e(k("API Error. Please contact administrator.")),e(G()))}))}));var t},saveSingleUser:function(a){return e(M(a))},updateSingleUser:function(a){return e((t=a,function(e){A.a.post(F.a+"".concat("Employee","/UpdateEmployee"),t,V).then((function(a){0===a.data.status?(e(D(a.data.message)),e(G())):(e(k(a.data.message)),e(G()))})).catch((function(a){a.response?(e(k(a.response.data.message||"ERROR")),e(G())):(e(k("API Error. Please contact administrator.")),e(G()))}))}));var t},deletUser:function(a){return e(function(e){return function(a){A.a.post(F.a+"".concat("Employee","/DeleteEmployee"),e,V).then((function(e){1==e.data?(a(D("User Data Deleted Successfully.")),a(G())):(a(k("User Delete Request Error. Please contact administrator.")),a(G()))})).catch((function(e){e.response?(a(k(e.response.data.message||"ERROR")),a(G())):(a(k("API Error. Please contact administrator.")),a(G()))}))}}(a))},getAllVesselList:function(a){return e(Object(H.b)(a))}}}))(W)}}]);
//# sourceMappingURL=15.810a5956.chunk.js.map